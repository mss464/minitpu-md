#-----------------------------------------------------------
# Vivado v2023.2 (64-bit)
# SW Build 4029153 on Fri Oct 13 20:13:54 MDT 2023
# IP Build 4028589 on Sat Oct 14 00:45:43 MDT 2023
# SharedData Build 4025554 on Tue Oct 10 17:18:54 MDT 2023
# Start of session at: Tue Feb 17 00:06:46 2026
# Process ID: 3991967
# Current directory: /home/mss464/minitpu/tpu
# Command line: vivado -mode batch -nojournal -source tensorcore/package_ip.tcl -tclargs -part xczu3eg-sbva484-1-i -out tensorcore/ip_repo -ip_name tensorcore -ip_version 1.0
# Log file: /home/mss464/minitpu/tpu/vivado.log
# Journal file: 
# Running On: brg-zhang-xcel.ece.cornell.edu, OS: Linux, CPU Frequency: 3200.000 MHz, CPU Physical cores: 23, Host memory: 235732 MB
#-----------------------------------------------------------
source tensorcore/package_ip.tcl
# set part        "xczu3eg-sbva484-1-i"
# set out_dir     "ip_repo"
# set ip_name     "tensorcore"
# set ip_version  "1.0"
# set ip_vendor   "cornell.edu"
# for {set i 0} {$i < $argc} {incr i} {
#     set arg [lindex $argv $i]
#     switch -exact -- $arg {
#         "-part"       { incr i; set part [lindex $argv $i] }
#         "-out"        { incr i; set out_dir [lindex $argv $i] }
#         "-ip_name"    { incr i; set ip_name [lindex $argv $i] }
#         "-ip_version" { incr i; set ip_version [lindex $argv $i] }
#         "-help" {
#             puts "Usage: vivado -mode batch -source package_ip.tcl -tclargs <options>"
#             puts "  -part <part>        FPGA part (default: xczu3eg-sbva484-1-i)"
#             puts "  -out <dir>          Output directory (default: ip_repo)"
#             puts "  -ip_name <name>     IP name (default: tensorcore)"
#             puts "  -ip_version <ver>   IP version (default: 1.0)"
#             exit 0
#         }
#     }
# }
# set script_dir [file dirname [file normalize [info script]]]
# set out_dir [file normalize $out_dir]
# puts "============================================================"
============================================================
# puts "TensorCore IP Packaging"
TensorCore IP Packaging
# puts "============================================================"
============================================================
# puts "Part:    $part"
Part:    xczu3eg-sbva484-1-i
# puts "Output:  $out_dir"
Output:  /home/mss464/minitpu/tpu/tensorcore/ip_repo
# puts "IP:      ${ip_vendor}:user:${ip_name}:${ip_version}"
IP:      cornell.edu:user:tensorcore:1.0
# puts "============================================================"
============================================================
# set proj_dir [file join [pwd] "pkg_${ip_name}_tmp"]
# file delete -force $proj_dir
# create_project pkg_${ip_name} $proj_dir -part $part -force
create_project: Time (s): cpu = 00:00:06 ; elapsed = 00:00:07 . Memory (MB): peak = 1563.797 ; gain = 0.023 ; free physical = 72430 ; free virtual = 165676
# puts "\n>>> Adding RTL files..."

>>> Adding RTL files...
# set sv_files [glob -directory $script_dir *.sv]
# foreach f $sv_files {
#     puts "  [file tail $f]"
#     add_files -norecurse $f
#     set_property file_type "SystemVerilog" [get_files $f]
# }
  compute_core.sv
  decoder.sv
  dummy_unit.sv
  fifo4.sv
  fp32_add.sv
  fp32_mul.sv
  mem_wrapper.sv
  mxu.sv
  pc.sv
  pe.sv
  scratchpad.sv
  sram_behavioral.sv
  systolic.sv
  vadd.sv
  vec_regfile.sv
  vpu.sv
  vpu_op.sv
  vpu_simd.sv
# puts "\n>>> Setting top module: compute_core"

>>> Setting top module: compute_core
# set_property top compute_core [current_fileset]
# update_compile_order -fileset sources_1
# puts "\n>>> Packaging IP..."

>>> Packaging IP...
# set ip_out [file join $out_dir "${ip_name}_${ip_version}"]
# file mkdir $ip_out
# ipx::package_project -root_dir $ip_out -vendor $ip_vendor -library user \
#     -taxonomy /UserIP -import_files -set_current true
WARNING: [IP_Flow 19-3833] Unreferenced file from the top module is not packaged: '/home/mss464/minitpu/tpu/tensorcore/decoder.sv'.
WARNING: [IP_Flow 19-3833] Unreferenced file from the top module is not packaged: '/home/mss464/minitpu/tpu/tensorcore/fifo4.sv'.
WARNING: [IP_Flow 19-3833] Unreferenced file from the top module is not packaged: '/home/mss464/minitpu/tpu/tensorcore/mem_wrapper.sv'.
WARNING: [IP_Flow 19-3833] Unreferenced file from the top module is not packaged: '/home/mss464/minitpu/tpu/tensorcore/pc.sv'.
WARNING: [IP_Flow 19-3833] Unreferenced file from the top module is not packaged: '/home/mss464/minitpu/tpu/tensorcore/scratchpad.sv'.
WARNING: [IP_Flow 19-3833] Unreferenced file from the top module is not packaged: '/home/mss464/minitpu/tpu/tensorcore/sram_behavioral.sv'.
WARNING: [IP_Flow 19-5101] Packaging a component with a SystemVerilog top file is not fully supported. Please refer to UG1118 'Creating and Packaging Custom IP'.
INFO: [IP_Flow 19-234] Refreshing IP repositories
INFO: [IP_Flow 19-1704] No user IP repositories specified
INFO: [IP_Flow 19-2313] Loaded Vivado IP repository '/opt/xilinx/Vivado/2023.2/data/ip'.
INFO: [IP_Flow 19-5107] Inferred bus interface 'rst_n' of definition 'xilinx.com:signal:reset:1.0' (from Xilinx Repository).
INFO: [IP_Flow 19-5107] Inferred bus interface 'clk' of definition 'xilinx.com:signal:clock:1.0' (from Xilinx Repository).
INFO: [IP_Flow 19-4728] Bus Interface 'rst_n': Added interface parameter 'POLARITY' with value 'ACTIVE_LOW'.
WARNING: [IP_Flow 19-5661] Bus Interface 'clk' does not have any bus interfaces associated with it.
WARNING: [IP_Flow 19-11770] Clock interface 'clk' has no FREQ_HZ parameter.
INFO: [IP_Flow 19-2181] Payment Required is not set for this core.
INFO: [IP_Flow 19-2187] The Product Guide file is missing.
# set core [ipx::current_core]
# set_property name $ip_name $core
# set_property version $ip_version $core
# set_property display_name "TPU Compute Core" $core
# set_property description "Portable TensorCore with systolic array and VPU" $core
# ipx::create_xgui_files $core
# ipx::update_checksums $core
# ipx::check_integrity $core
WARNING: [IP_Flow 19-5661] Bus Interface 'clk' does not have any bus interfaces associated with it.
WARNING: [IP_Flow 19-11770] Clock interface 'clk' has no FREQ_HZ parameter.
INFO: [IP_Flow 19-2181] Payment Required is not set for this core.
INFO: [IP_Flow 19-2187] The Product Guide file is missing.
INFO: [Ipptcl 7-1486] check_integrity: Integrity check passed.
# ipx::save_core $core
# close_project
# file delete -force $proj_dir
# puts ""

# puts "============================================================"
============================================================
# puts "IP packaged: $ip_out"
IP packaged: /home/mss464/minitpu/tpu/tensorcore/ip_repo/tensorcore_1.0
# puts "VLNV: ${ip_vendor}:user:${ip_name}:${ip_version}"
VLNV: cornell.edu:user:tensorcore:1.0
# puts "============================================================"
============================================================
# exit 0
INFO: [Common 17-206] Exiting Vivado at Tue Feb 17 00:07:00 2026...
